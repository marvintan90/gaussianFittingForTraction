function [pkcoords,pkshift] = detpkViagauss(coords,Im)%takes all the estimated coords of the peaks, returns all the pk estimates via%gaussian fitting    for n=1:size(coords,1)      xc = coords(n,1);      yc = coords(n,2);      [xr,yr]=buildcoords(xc,yc,Im);      z=Im(yr,xr);  % row=y, column=x      [x,resnorm,residual,exitflag,output,xdata, xpk, ypk, xSig, ySig] = D2GaussFit(z) ;      pkcoords(n,:) = [(xc+xpk) , (yc+ypk) , xSig , ySig];      pkshift(n,:) = [xpk , ypk] ; % add to the list of coordinates    endend